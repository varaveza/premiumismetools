<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Creator Tools</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="shortcut icon" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --very-peri: #5B5C9A; --dark-peri: #3E3F6A; --darker-peri: #2A2B4F; --darkest-peri: #1F2030;
            --accent: #7A6EB7; --light-peri: #898AC8; --text-light: #E8E8F5;
            --shadow-color: rgba(0, 0, 0, 0.3); --highlight-color: rgba(255, 255, 255, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.15);
            --accent-glass-bg: rgba(154, 155, 217, 0.15); --accent-border: rgba(139, 126, 200, 0.7);
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--darkest-peri) 0%, var(--darker-peri) 50%, var(--dark-peri) 100%);
            min-height: 100vh; color: var(--text-light); overflow-x: hidden;
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; }
        .shape {
            position: absolute; background: var(--accent-glass-bg); border-radius: 50%;
            animation: float 10s ease-in-out infinite alternate; filter: blur(8px);
            transform: translate(var(--parallax-x, 0px), var(--parallax-y, 0px));
            transition: transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
        }
        .shape:nth-child(1) { width: 150px; height: 150px; top: 10%; left: 10%; animation-duration: 12s; }
        .shape:nth-child(2) { width: 100px; height: 100px; top: 30%; right: 15%; animation-duration: 8s; animation-delay: -2s; }
        .shape:nth-child(3) { width: 120px; height: 120px; bottom: 15%; left: 20%; animation-duration: 10s; animation-delay: -4s; }
        .shape:nth-child(4) { width: 80px; height: 80px; bottom: 40%; right: 25%; animation-duration: 14s; animation-delay: -6s; }
        .shape:nth-child(5) { width: 60px; height: 60px; top: 50%; left: 40%; animation-duration: 9s; animation-delay: -3s; opacity: 0.7;}
        @keyframes float {
            0% { transform: translateY(0px) translateX(0px) rotate(0deg) scale(1); }
            50% { transform: translateY(-30px) translateX(20px) rotate(180deg) scale(1.1); }
            100% { transform: translateY(10px) translateX(-10px) rotate(360deg) scale(1); }
        }
        .container-main {
            max-width: 1200px; width: 100%; padding: 25px 30px;
            background: var(--glass-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border-radius: 25px; border: 1px solid var(--glass-border);
            box-shadow: 0 15px 35px var(--shadow-color);
            animation: fadeInScaleUp 0.8s ease-out forwards; z-index: 1;
        }
        @keyframes fadeInScaleUp { from { opacity: 0; transform: scale(0.95) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }
        
        .header {
            text-align: center; margin-bottom: 35px;
        }
        .header h1 {
            font-size: 26px; font-weight: 700; margin-bottom: 8px;
            background: linear-gradient(45deg, var(--light-peri), var(--accent));
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 15px rgba(154, 155, 217, 0.2);
        }
        .header p { color: var(--text-light); opacity: 0.85; font-size: 15px; line-height: 1.6; }
        
        .nav-tabs {
            display: flex; justify-content: center; margin-bottom: 30px;
            background: var(--accent-glass-bg); border-radius: 15px; padding: 5px;
            backdrop-filter: blur(12px); border: 1px solid var(--glass-border);
        }
        .nav-tab {
            background: transparent; border: none; color: var(--text-light);
            padding: 15px 30px; border-radius: 10px; cursor: pointer;
            font-size: 1rem; font-weight: 600; transition: all 0.3s ease; margin: 0 5px;
        }
        .nav-tab.active {
            background: rgba(154, 155, 217, 0.3); color: var(--text-light);
        }
        .nav-tab:hover {
            background: var(--accent-glass-bg);
        }
        
        .stats-container {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px; margin-bottom: 40px;
        }
        .stat-card {
            background: var(--accent-glass-bg); backdrop-filter: blur(12px);
            border-radius: 15px; padding: 25px; text-align: center;
            border: 1px solid var(--glass-border); box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px) scale(1.02); background: rgba(154, 155, 217, 0.3);
            border-color: var(--accent-border); box-shadow: 0 10px 25px rgba(0,0,0,0.25);
        }
        .stat-card i {
            font-size: 2.5rem; margin-bottom: 15px; color: var(--accent);
            filter: drop-shadow(0 0 4px rgba(139, 126, 200, 0.4));
        }
        .stat-card h3 {
            font-size: 2rem; font-weight: 700; margin-bottom: 10px; color: var(--text-light);
        }
        .stat-card p { color: var(--text-light); opacity: 0.85; font-size: 1rem; }
        
        .content-wrapper {
            max-width: 800px; margin: 0 auto;
        }
        .content-section {
            background: var(--accent-glass-bg); backdrop-filter: blur(12px);
            border-radius: 15px; padding: 25px; margin-bottom: 30px;
            border: 1px solid var(--glass-border); box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        .content-section h2 {
            text-align: center; margin-bottom: 25px; color: var(--text-light);
            font-size: 1.5rem; font-weight: 600;
        }
        
        .form-input {
            width: 100%; padding: 16px 20px; border: 1px solid var(--glass-border);
            border-radius: 15px; font-size: 1rem; transition: all 0.3s ease;
            font-family: inherit; background: var(--glass-bg); color: var(--text-light);
        }
        .form-input:focus {
            outline: none; border-color: var(--accent-border);
            background: rgba(154, 155, 217, 0.2); box-shadow: 0 0 0 3px rgba(139, 126, 200, 0.2);
        }
        .form-input::placeholder { color: var(--text-light); opacity: 0.6; }
        
        .btn {
            padding: 16px 20px; border: none; border-radius: 15px; font-size: 1rem;
            font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            display: inline-flex; align-items: center; gap: 15px; text-decoration: none;
            background: var(--accent-glass-bg); color: var(--text-light);
            border: 1px solid var(--glass-border); box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        .btn:hover {
            transform: translateY(-5px) scale(1.02); background: rgba(154, 155, 217, 0.3);
            border-color: var(--accent-border); box-shadow: 0 10px 25px rgba(0,0,0,0.25);
        }
        .btn-primary {
            background: linear-gradient(45deg, var(--accent), var(--light-peri));
            color: var(--text-light); width: 100%; border: none;
        }
        .btn-primary:hover {
            background: linear-gradient(45deg, var(--light-peri), var(--accent));
        }
        .btn-secondary {
            background: var(--accent-glass-bg); color: var(--text-light);
        }
        .btn:disabled {
            opacity: 0.6; cursor: not-allowed; transform: none;
        }
        
        .space-y-4 > * + * { margin-top: 20px; }
        .result-card {
            background: var(--glass-bg); border-radius: 15px; padding: 20px;
            border: 1px solid var(--glass-border); box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .hidden { display: none; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .text-white { color: var(--text-light); }
        .text-xl { font-size: 20px; }
        .font-bold { font-weight: 700; }
        .mb-4 { margin-bottom: 16px; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .sm\:flex-row { flex-direction: row; }
        .justify-between { justify-content: space-between; }
        .items-center { align-items: center; }
        .gap-4 { gap: 16px; }
        .gap-2 { gap: 8px; }
        .gap-3 { gap: 12px; }
        .text-sm { font-size: 14px; }
        .w-full { width: 100%; }
        .mt-2 { margin-top: 8px; }
        .resize-none { resize: none; }
        .flex-grow { flex-grow: 1; }
        .p-3 { padding: 12px; }
        .flex-1 { flex: 1; }
        .whitespace-nowrap { white-space: nowrap; }
        
        .toast {
            position: fixed; top: 20px; right: 20px; padding: 15px 20px;
            border-radius: 15px; color: var(--text-light); font-weight: 500;
            z-index: 1000; animation: slideIn 0.3s ease;
            background: var(--accent-glass-bg); border: 1px solid var(--glass-border);
            backdrop-filter: blur(12px);
        }
        .toast.success { background: rgba(34, 197, 94, 0.2); border-color: rgba(34, 197, 94, 0.5); }
        .toast.error { background: rgba(239, 68, 68, 0.2); border-color: rgba(239, 68, 68, 0.5); }
        .toast.info { background: var(--accent-glass-bg); border-color: var(--glass-border); }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @media (max-width: 768px) {
            .container-main { padding: 20px; }
            .content-section { padding: 20px; }
            .stats-container { grid-template-columns: 1fr; }
            .flex-col.sm\:flex-row { flex-direction: column; }
            .header h1 { font-size: 22px; }
        }
    </style>
</head>
    <body>
        <div class="bg-animation">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>

    <main class="container-main">
        <!-- Header -->
        <header class="header">
            <!-- Mobile Hamburger Menu -->
            <div class="mobile-nav-toggle" onclick="toggleMobileNav()">
                <i class="fas fa-bars"></i>
            </div>

            <!-- Logo -->
            <div class="logo-container">
                <h1 class="text-white text-2xl font-bold">🎵 Spotify Creator</h1>
            </div>

            <!-- Desktop Navigation -->
            <nav class="desktop-nav">
                <a href="/" class="nav-link active">Spotify Creator</a>
                <a href="/shortlink" class="nav-link">Shortlink</a>
            </nav>

            <!-- Mobile Navigation Overlay -->
            <div id="mobile-nav" class="mobile-nav">
                <div class="mobile-nav-content">
                    <a href="/" class="mobile-nav-link active">Spotify Creator</a>
                    <a href="/shortlink" class="mobile-nav-link">Shortlink</a>
                    <button onclick="toggleMobileNav()" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>
        </header>

        <!-- Stats Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3 id="dailyUsed">-</h3>
                <p>Daily Used</p>
            </div>
            <div class="stat-card">
                <h3 id="dailyRemaining">-</h3>
                <p>Daily Remaining</p>
            </div>
            <div class="stat-card">
                <h3 id="totalAccounts">-</h3>
                <p>Total Accounts</p>
            </div>
            <div class="stat-card">
                <h3 id="totalShortlinks">-</h3>
                <p>Total Shortlinks</p>
            </div>
        </div>

        <!-- Content Wrapper untuk standarisasi layout -->
        <div class="content-wrapper">
            <!-- Input Section -->
            <div id="main-section" class="fade-in">
                <div class="content-section">
                    <h2>Pengaturan Spotify Creator</h2>
                    <div class="space-y-4">
                        <div class="result-card">
                            <label class="block text-sm font-medium mb-3">Email Address (Auto-Generated)</label>
                            <div class="flex items-center gap-3">
                                <input type="email" id="email" class="form-input flex-1" readonly>
                                <button onclick="regenerateEmail()" class="btn btn-secondary text-sm whitespace-nowrap">
                                    <i class="fas fa-sync-alt"></i> New Email
                                </button>
                            </div>
                        </div>
                        <div>
                            <label for="password" class="block text-sm font-medium opacity-80 mb-2">Password</label>
                            <input type="password" id="password" placeholder="Minimal 6 karakter" class="form-input">
                        </div>
                        <div>
                            <label for="name" class="block text-sm font-medium opacity-80 mb-2">Display Name</label>
                            <input type="text" id="name" placeholder="Nama yang akan ditampilkan" class="form-input">
                        </div>
                        <div class="result-card">
                            <label for="accountType" class="block text-sm font-medium mb-3">Tipe Akun</label>
                            <select id="accountType" class="form-input">
                                <option value="regular">Regular Account</option>
                                <option value="student">Student Account</option>
                            </select>
                        </div>
                        <button onclick="createSpotifyAccount()" class="w-full mt-2 btn btn-primary">
                            <i class="fas fa-plus-circle"></i> Create Spotify Account
                        </button>
                    </div>
                </div>
            </div>

            <!-- Result Section -->
            <div id="result-section" class="hidden fade-in">
                <div class="content-section">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
                        <h3 class="text-xl font-bold">Hasil Akun Spotify (<span id="resultCount">0</span>)</h3>
                        <div class="flex gap-2">
                            <button class="btn btn-secondary text-sm" onclick="backToInput()">
                                <i class="fas fa-arrow-left"></i> Kembali
                            </button>
                            <button id="copyGeneratedButton" class="btn btn-secondary text-sm" onclick="copyGeneratedAccounts()" disabled>
                                <i class="fas fa-copy"></i> Salin
                            </button>
                            <button id="downloadGeneratedButton" class="btn btn-secondary text-sm" onclick="downloadGeneratedAccounts()" disabled>
                                <i class="fas fa-download"></i> Unduh
                            </button>
                        </div>
                    </div>
                    <textarea id="resultOutput" class="w-full flex-grow p-3 form-input resize-none" readonly placeholder="Hasil akun Spotify akan muncul di sini..."></textarea>
                </div>
            </div>
        </div>
    </main>



    <script>
        let generatedAccounts = [];
        let currentStats = {};

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadStats();
            generateEmail();
        });

        function toggleMobileNav() {
            const mobileNav = document.getElementById('mobile-nav');
            mobileNav.classList.toggle('hidden');
        }

        function createSpotifyAccount() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            const name = document.getElementById('name').value.trim();
            const accountType = document.getElementById('accountType').value;

            if (!email || !password || !name) {
                showToast('Mohon masukkan semua data yang diperlukan.', 'error');
                return;
            }

            if (password.length < 6) {
                showToast('Password minimal 6 karakter.', 'error');
                return;
            }

            // Check daily limit
            if (currentStats.daily_used >= 100) {
                showToast('Batas maksimal 100 akun per hari telah tercapai.', 'error');
                return;
            }

            // Simulate account creation
            const account = {
                email: email,
                password: password,
                name: name,
                type: accountType,
                status: 'Created',
                timestamp: new Date().toLocaleString('id-ID')
            };

            generatedAccounts = [account];
            displayGeneratedResults();
            showToast('Akun Spotify berhasil dibuat!', 'success');

            document.getElementById('main-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');

            // Update stats
            updateStats();
        }

        function displayGeneratedResults() {
            const resultOutput = document.getElementById('resultOutput');
            const resultCount = document.getElementById('resultCount');
            const downloadBtn = document.getElementById('downloadGeneratedButton');
            const copyBtn = document.getElementById('copyGeneratedButton');

            const outputText = generatedAccounts.map(acc => 
                `Email: ${acc.email}\nPassword: ${acc.password}\nName: ${acc.name}\nType: ${acc.type}\nStatus: ${acc.status}\nCreated: ${acc.timestamp}\n`
            ).join('\n');

            resultOutput.value = outputText;
            resultCount.textContent = generatedAccounts.length;

            const hasResults = generatedAccounts.length > 0;
            downloadBtn.disabled = !hasResults;
            copyBtn.disabled = !hasResults;
        }

        function backToInput() {
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('main-section').classList.remove('hidden');
            generatedAccounts = [];
            displayGeneratedResults();
        }

        function copyGeneratedAccounts() {
            if (generatedAccounts.length === 0) return;
            
            const resultOutput = document.getElementById('resultOutput');
            resultOutput.select();
            document.execCommand('copy');
            
            showToast(`${generatedAccounts.length} akun berhasil disalin!`, 'success');
        }

        function downloadGeneratedAccounts() {
            if (generatedAccounts.length === 0) return;
            
            const accountsText = generatedAccounts.map(acc => 
                `Email: ${acc.email}\nPassword: ${acc.password}\nName: ${acc.name}\nType: ${acc.type}\nStatus: ${acc.status}\nCreated: ${acc.timestamp}`
            ).join('\n\n');
            
            const blob = new Blob([accountsText], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `spotify-accounts.txt`;
            a.click();
            window.URL.revokeObjectURL(url);
            
            showToast('File berhasil diunduh!', 'success');
        }



        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                currentStats = data;
                document.getElementById('dailyUsed').textContent = data.daily_used;
                document.getElementById('dailyRemaining').textContent = data.daily_remaining;
                document.getElementById('totalAccounts').textContent = data.total_accounts;
                document.getElementById('totalShortlinks').textContent = data.total_shortlinks || 0;
            } catch (error) {
                console.error('Error loading stats:', error);
                // Set default values if API fails
                document.getElementById('dailyUsed').textContent = '0';
                document.getElementById('dailyRemaining').textContent = '100';
                document.getElementById('totalAccounts').textContent = '0';
                document.getElementById('totalShortlinks').textContent = '0';
            }
        }

        function updateStats() {
            if (currentStats.daily_used !== undefined) {
                currentStats.daily_used++;
                currentStats.daily_remaining = Math.max(0, 100 - currentStats.daily_used);
                
                document.getElementById('dailyUsed').textContent = currentStats.daily_used;
                document.getElementById('dailyRemaining').textContent = currentStats.daily_remaining;
            }
        }

        function generateEmail() {
            // Generate username like in main.py
            const baseUsername = generateRandomUsername();
            const randomNumbers = Math.floor(Math.random() * 900) + 100; // 100-999
            const username = (baseUsername + randomNumbers).substring(0, 12);
            const domain = 'rajaiblis.com'; // Using domain from main.py
            
            const email = `${username}@${domain}`;
            document.getElementById('email').value = email;
        }

        function generateRandomUsername() {
            const adjectives = ['cool', 'smart', 'happy', 'brave', 'wise', 'quick', 'bright', 'calm', 'eager', 'gentle'];
            const nouns = ['cat', 'dog', 'bird', 'fish', 'lion', 'tiger', 'bear', 'wolf', 'eagle', 'shark'];
            
            const adj = adjectives[Math.floor(Math.random() * adjectives.length)];
            const noun = nouns[Math.floor(Math.random() * nouns.length)];
            
            return (adj + noun).toLowerCase().replace(/[^a-z0-9]/g, '');
        }

        function regenerateEmail() {
            generateEmail();
            showToast('Email baru berhasil di-generate!', 'info');
        }



        // Auto-refresh stats every 30 seconds
        setInterval(loadStats, 30000);
    </script>
</body>
</html>
